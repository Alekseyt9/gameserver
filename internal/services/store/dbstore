package store

import (
	"database/sql"

	_ "github.com/golang-migrate/migrate/v4/database/postgres" // needs for init
	_ "github.com/golang-migrate/migrate/v4/source/file"
)

type DBStorage struct {
	conn *sql.DB
}

func NewDBStorage(connString string) (*DBStorage, error) {
	conn, err := sql.Open("pgx", connString)
	if err != nil {
		return nil, err
	}

	err = bootstrap(connString)
	if err != nil {
		return nil, err
	}

	return &DBStorage{
		conn: conn,
	}, nil
}
